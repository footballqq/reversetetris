# T03 - 方块系统 (PieceFactory)

## 阶段
**Phase 2: 核心逻辑**

## 目标
实现 7 种标准俄罗斯方块（Tetrominoes）的定义和旋转逻辑。

## 任务清单

### 3.1 方块类型定义
- [ ] 创建 `src/core/Piece.ts`
- [ ] 定义 7 种方块类型枚举
```typescript
enum PieceType {
  I, O, T, S, Z, J, L
}
```

### 3.2 方块形状数据
- [ ] 创建 `src/core/PieceData.ts`
- [ ] 为每种方块定义 4 个旋转状态的形状矩阵
- [ ] 使用相对坐标表示（相对于旋转中心）

```typescript
// 示例：T 方块的 4 个旋转状态
const T_SHAPES = [
  [[0,-1], [0,0], [0,1], [-1,0]],   // 0°
  [[-1,0], [0,0], [1,0], [0,1]],    // 90°
  [[0,-1], [0,0], [0,1], [1,0]],    // 180°
  [[-1,0], [0,0], [1,0], [0,-1]],   // 270°
];
```

### 3.3 Piece 类
- [ ] `type`: 方块类型
- [ ] `rotation`: 当前旋转状态 (0-3)
- [ ] `getBlocks(rotation?)`: 获取方块相对坐标
- [ ] `getColor()`: 获取方块颜色

### 3.4 PieceFactory
- [ ] 创建 `src/core/PieceFactory.ts`
- [ ] `createRandom()`: 随机生成一个方块
- [ ] `createRandomSet(count)`: 生成指定数量的随机方块集（用于三选一）
- [ ] 实现 7-bag 随机算法（可选，保证公平性）

### 3.5 颜色配置
```typescript
const PIECE_COLORS = {
  I: '#00f0f0', // 青色
  O: '#f0f000', // 黄色
  T: '#a000f0', // 紫色
  S: '#00f000', // 绿色
  Z: '#f00000', // 红色
  J: '#0000f0', // 蓝色
  L: '#f0a000', // 橙色
};
```

## 验收标准
- 可以正确生成 7 种方块
- 方块的 4 个旋转状态数据正确
- 随机生成功能正常

## 预计工时
1-2 小时

## 依赖
- T01（项目结构）
