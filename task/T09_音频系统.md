# T09 - 音频系统 (AudioManager)

## 阶段
**Phase 6: UI/UX 打磨**

## 目标
使用 Web Audio API 实时合成音效和背景音乐，无需外部音频文件。

## 任务清单

### 9.1 AudioManager 类
- [ ] 创建 `src/audio/AudioManager.ts`
- [ ] 初始化 AudioContext
- [ ] 音量控制（主音量、BGM 音量、SFX 音量）
- [ ] 静音开关

### 9.2 音效合成 (SFX)
- [ ] `playSelect()`: 选择方块音效（短促高音）
- [ ] `playDrop()`: 方块落地音效（低音"咚"）
- [ ] `playClear()`: 消行音效（上升音阶）
- [ ] `playGameOver()`: 游戏结束音效（下降音阶）
- [ ] `playWin()`: 胜利音效（欢快旋律）

### 9.3 音效实现示例
```typescript
playDrop() {
  const osc = this.ctx.createOscillator();
  const gain = this.ctx.createGain();
  
  osc.type = 'sine';
  osc.frequency.setValueAtTime(150, this.ctx.currentTime);
  osc.frequency.exponentialRampToValueAtTime(50, this.ctx.currentTime + 0.1);
  
  gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.15);
  
  osc.connect(gain);
  gain.connect(this.ctx.destination);
  
  osc.start();
  osc.stop(this.ctx.currentTime + 0.15);
}
```

### 9.4 背景音乐 (BGM)
- [ ] 8-bit 风格循环 BGM
- [ ] 使用多个振荡器模拟旋律和节奏
- [ ] 简单的 4 小节循环

### 9.5 BGM 结构
```
节奏: 简单的鼓点节奏（噪声波形）
低音: 低频正弦波，简单的低音线
旋律: 方波/锯齿波，4-8 个音符循环
```

### 9.6 用户偏好
- [ ] 保存音量设置到 localStorage
- [ ] 首次加载需要用户交互才能播放（浏览器限制）

## 验收标准
- 所有音效可以正常播放
- BGM 循环播放无卡顿
- 静音功能正常

## 预计工时
3-4 小时

## 依赖
- T06（在游戏事件中触发音效）
